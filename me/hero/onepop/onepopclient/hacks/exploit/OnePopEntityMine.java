package me.hero.onepop.onepopclient.hacks.exploit;

import me.hero.onepop.onepopclient.hacks.OnePopCategory;
import me.hero.onepop.onepopclient.hacks.OnePopHack;
import net.minecraft.entity.EntityLivingBase;
import net.minecraft.util.EnumFacing;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.math.RayTraceResult;
import net.minecraft.util.math.RayTraceResult.Type;

public class OnePopEntityMine extends OnePopHack {
   private boolean focus = false;

   public OnePopEntityMine() {
      super(OnePopCategory.ONEPOP_EXPLOIT);
      this.name = "Entity Mine";
      this.tag = "EntityMine";
      this.description = "mine through stuff";
   }

   public void update() {
      mc.field_71441_e.field_72996_f.stream().filter((entity) -> {
         return entity instanceof EntityLivingBase;
      }).filter((entity) -> {
         return mc.field_71439_g == entity;
      }).map((entity) -> {
         return (EntityLivingBase)entity;
      }).filter((entity) -> {
         return !entity.field_70128_L;
      }).forEach(this::process);
      RayTraceResult normal_result = mc.field_71476_x;
      if (normal_result != null) {
         this.focus = normal_result.field_72313_a == Type.ENTITY;
      }

   }

   private void process(EntityLivingBase event) {
      RayTraceResult bypass_entity_result = event.func_174822_a(6.0D, mc.func_184121_ak());
      if (bypass_entity_result != null && this.focus && bypass_entity_result.field_72313_a == Type.BLOCK) {
         BlockPos block_pos = bypass_entity_result.func_178782_a();
         if (mc.field_71474_y.field_74312_F.func_151470_d()) {
            mc.field_71442_b.func_180512_c(block_pos, EnumFacing.UP);
         }
      }

   }
}
